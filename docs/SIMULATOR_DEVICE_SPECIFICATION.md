# 模擬器設備規格詳細比對
## Simulator Device Specification Comparison

**文件版本**: 1.0  
**建立日期**: 2025.11.15  
**狀態**: 規格確認

---

## 📋 設備規格比對表

### 1. 流量計 (AFM07)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 1 | 1 | ✅ 符合 |
| **寄存器地址** | 0x0000 (瞬时流量) | 0x0000 | ✅ 符合 |
| | 0x0001-0x0002 (累計流量) | 0x0001-0x0002 | ✅ 符合 |
| **數據類型** | Unsigned Int16 (瞬时) | Unsigned Int16 | ✅ 符合 |
| | Unsigned Int32 (累計) | Unsigned Int32 | ✅ 符合 |
| **換算公式** | 瞬时: ÷ 10 | ÷ 10 | ✅ 符合 |
| | 累計: ÷ 10 | ÷ 10 | ✅ 符合 |
| **功能碼** | 0x03 (Read Holding Registers) | 0x03 | ✅ 符合 |
| **輪詢頻率** | 1 Hz | 1 Hz | ✅ 符合 |
| **UART 設定** | 19200/8/NONE/1 | 需在串口橋接器設定 | ⚠️ 需確認 |

**模擬器實作狀態**: ✅ 已實作（符合規格）

---

### 2. 壓力計 (Delta DPA) - 正壓

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 2 | 2 | ✅ 符合 |
| **寄存器地址** | 0x1000 (PV 值) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Unsigned Int16 | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | × 0.1 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 (Read Holding Registers) | 0x03 | ✅ 符合 |
| **輪詢頻率** | 1 Hz | ❌ 未明確 | ⚠️ **需補充** |
| **UART 設定** | 19200/8/EVEN/1 | 需在串口橋接器設定 | ⚠️ 需確認 |
| **量測範圍** | 0 ~ 10 kg/cm² (0 ~ 1.0 MPa) | ❌ 未明確 | ⚠️ **需補充** |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 3. 壓力計 (Delta DPA) - 真空

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 3 | 3 | ✅ 符合 |
| **寄存器地址** | 0x1000 (PV 值) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Unsigned Int16 | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | × 0.1 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 (Read Holding Registers) | 0x03 | ✅ 符合 |
| **輪詢頻率** | 1 Hz | ❌ 未明確 | ⚠️ **需補充** |
| **UART 設定** | 19200/8/EVEN/1 | 需在串口橋接器設定 | ⚠️ 需確認 |
| **量測範圍** | 0 ~ -100 kPa (0 ~ -0.1 MPa) | ❌ 未明確 | ⚠️ **需補充** |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 4. DC 電表 (JX3101)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 1 | 1 | ✅ 符合 |
| **寄存器地址** | 0x1000-0x1001 (電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1002-0x1003 (電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1004-0x1005 (功率, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Signed Int32 (所有參數) | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | 電壓: ÷ 100 | ❌ 未明確 | ⚠️ **需補充** |
| | 電流: ÷ 1000 | ❌ 未明確 | ⚠️ **需補充** |
| | 功率: ÷ 10000 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 (Read Holding Registers) | 0x03 | ✅ 符合 |
| **輪詢頻率** | 2 Hz (0.5秒) | ❌ 未明確 | ⚠️ **需補充** |
| **UART 設定** | 57600/8/NONE/1 | 需在串口橋接器設定 | ⚠️ 需確認 |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 5. AC110V 電表 (JX3101)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 2 | 2 | ✅ 符合 |
| **寄存器地址** | 0x1000-0x1001 (電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1002-0x1003 (電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Signed Int32 (所有參數) | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | 電壓: ÷ 100, 電流: ÷ 1000 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 | 0x03 | ✅ 符合 |
| **輪詢頻率** | 2 Hz | ❌ 未明確 | ⚠️ **需補充** |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 6. AC220V 電表 (JX3101)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 3 | 3 | ✅ 符合 |
| **寄存器地址** | 0x1000-0x1001 (電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1002-0x1003 (電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Signed Int32 (所有參數) | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | 電壓: ÷ 100, 電流: ÷ 1000 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 | 0x03 | ✅ 符合 |
| **輪詢頻率** | 2 Hz | ❌ 未明確 | ⚠️ **需補充** |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 7. AC220V 3P 電表 (JX8304M)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 4 | 4 | ✅ 符合 |
| **寄存器地址** | 0x1000-0x1001 (A相電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1002-0x1003 (B相電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1004-0x1005 (C相電壓, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1006-0x1007 (A相電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1008-0x1009 (B相電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x100A-0x100B (C相電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x100C-0x100D (漏電流, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x100E-0x100F (A相功率, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1010-0x1011 (B相功率, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1012-0x1013 (C相功率, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x1014-0x1015 (合相功率, Int32) | ❌ 未明確 | ⚠️ **需補充** |
| **數據類型** | Signed Int32 (所有參數) | ❌ 未明確 | ⚠️ **需補充** |
| **換算公式** | 電壓: ÷ 100, 電流: ÷ 1000, 功率: ÷ 10000 | ❌ 未明確 | ⚠️ **需補充** |
| **功能碼** | 0x03 | 0x03 | ✅ 符合 |
| **輪詢頻率** | 2 Hz | ❌ 未明確 | ⚠️ **需補充** |
| **讀取長度** | 17 個寄存器 (34 bytes) | ❌ 未明確 | ⚠️ **需補充** |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

### 8. 繼電器 IO 模組 (Waveshare)

| 項目 | 真實設備規格 | 模擬器規格 | 狀態 |
|------|------------|-----------|------|
| **RTU 地址** | 1 | 1 | ✅ 符合 |
| **功能碼** | 0x02 (Read Discrete Inputs) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x05 (Write Single Coil) | ❌ 未明確 | ⚠️ **需補充** |
| | 0x0F (Write Multiple Coils) | ❌ 未明確 | ⚠️ **需補充** |
| **線圈地址** | 0x0000-0x0007 (CH1-CH8) | ❌ 未明確 | ⚠️ **需補充** |
| **控制值** | 0xFF00 (ON), 0x0000 (OFF) | ❌ 未明確 | ⚠️ **需補充** |
| **Discrete Inputs** | 0x0000 (Bit 0-7) | ❌ 未明確 | ⚠️ **需補充** |
| | Bit 0: 緊急停止 | ❌ 未明確 | ⚠️ **需補充** |
| | Bit 1: 測試蓋狀態 | ❌ 未明確 | ⚠️ **需補充** |
| **輪詢頻率** | 100 Hz (0.01秒) | ❌ 未明確 | ⚠️ **需補充** |
| **UART 設定** | 115200/8/NONE/1 | 需在串口橋接器設定 | ⚠️ 需確認 |

**模擬器實作狀態**: ❌ **未實作**（需補充）

---

## ⚠️ 發現的問題

### 1. 缺少詳細實作
- ❌ 電表模擬器：缺少 Int32 數據格式實作
- ❌ 壓力計模擬器：缺少 0x1000 寄存器地址和 × 0.1 換算
- ❌ 繼電器 IO 模擬器：缺少 Discrete Inputs 和 Coils 實作

### 2. 寄存器地址映射
- ⚠️ 壓力計使用 0x1000，但模擬器基礎類別從 0 開始
- ⚠️ 電表使用 0x1000，需要正確映射

### 3. 數據格式
- ⚠️ Int32 需要 2 個寄存器組合，模擬器需要正確處理
- ⚠️ 負數處理（補碼格式）

### 4. UART 設定
- ⚠️ 不同設備使用不同的 UART 設定，串口橋接器需要支援

---

## ✅ 建議修正

需要在模擬器架構文件中補充：
1. 完整的電表模擬器實作（支援 Int32）
2. 完整的壓力計模擬器實作（0x1000 寄存器）
3. 完整的繼電器 IO 模擬器實作（Discrete Inputs + Coils）
4. 串口橋接器的 UART 設定配置



